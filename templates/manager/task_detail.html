{% extends "base.html" %}

{% block content %}
  <h2>{{ task.name }}</h2>

  <p><strong>Status:</strong> {{ task.get_status_display }}</p>
  <p><strong>Type:</strong> {{ task.task_type.name }}</p>
  <p><strong>Priority:</strong> {{ task.priority }}</p>
  <p><strong>Deadline:</strong> {{ task.deadline }}</p>
  <p><strong>Description:</strong> {{ task.description }}</p>

  <p><strong>Assignees:</strong>
    {% for user in task.assignees.all %}
      {{ user.username }}{% if not forloop.last %}, {% endif %}
    {% empty %}
      <em>None</em>
    {% endfor %}
  </p>

  <p><strong>Tags:</strong>
    {% for tag in task.tags.all %}
      <span class="badge bg-secondary">{{ tag.name }}</span>
    {% empty %}
      <em>None</em>
    {% endfor %}
  </p>

  <hr>

  <h5>Comments</h5>
  {% for comment in comments %}
    <div class="mb-2 p-2 border rounded">
      <small><strong>{{ comment.created_by.username }}</strong> â€” {{ comment.created_time|date:"Y-m-d H:i" }}</small>
      <p class="mb-0">{{ comment.content }}</p>
    </div>
  {% empty %}
    <p>No comments yet.</p>
  {% endfor %}

  {% if user.is_authenticated %}
    <hr>
    <h5>Add a comment</h5>
    <form method="post">
      {% csrf_token %}
      {{ form.as_p }}
      <button type="submit" class="btn btn-primary">Submit</button>
    </form>
  {% else %}
    <hr>
    <p><em><a href="{% url 'login' %}?next={{ request.path }}">Log in</a> to leave a comment.</em></p>
  {% endif %}


  <a href="{% url 'manager:task-list' %}" class="btn btn-outline-secondary mt-3">Back to list</a>
{% endblock %}
